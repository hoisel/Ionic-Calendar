function CalendarController(a,b,c,d,e,f,g,h,i,j){"use strict";function k(){"local"===u.queryMode?u.eventSources&&o&&o():"remote"===u.queryMode&&u.rangeChanged&&u.rangeChanged({startTime:u.range.startTime,endTime:u.range.endTime})}function l(){var a=u.range.startTime,b=a.getDate(),c=(a.getMonth()+(1!==b?1:0))%12,d=a.getFullYear()+(1!==b&&0===c?1:0),e=new Date(d,c,1);return f(e,u.formatMonthTitle)}function m(a,b){var c,d=u.mode.step,e=new Date(a),f=e.getFullYear(),g=e.getMonth()+b*(d.months||0),h=1;return e.setFullYear(f,g,h),c=new Date(f,g+1,1),c.getTime()<=e.getTime()&&(e=new Date(c-864e5)),e}function n(a){var b,c=a,d=c.getDate(),e=(c.getMonth()+(1!==d?1:0))%12,f=q(c,42);for(b=0;b<42;b++)f[b]=angular.extend(r(f[b],u.formatDay),{secondary:f[b].getMonth()!==e});return{dates:f}}function o(){var a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q=u.eventSources,r=q?q.length:0,s=u.range.startTime,v=u.range.endTime,x=-(new Date).getTimezoneOffset(),y=new Date(s.getTime()+60*x*1e3),z=new Date(v.getTime()+60*x*1e3),A=u.currentViewIndex,B=u.views[A].dates,C=864e5,D=.001;for(d=0;d<42;d+=1)c=B[d],c.hasEvent&&(c.hasEvent=!1,c.events=[],c.eventSources={});for(g=0;g<r;g+=1)for(a=q[g],b=a&&a.items?a.items.length:0,e=0;e<b;e+=1){if(h=a.items[e],h.allDay=!!h.start.date,h.allDay?(i=new Date(h.start.date),j=new Date(h.end.date)):(i=new Date(h.start.dateTime),j=new Date(h.end.dateTime)),h.allDay){if(j<=y||i>=z)continue;k=y,l=z}else{if(j<=s||i>=v)continue;k=s,l=v}for(i.getDate()==j.getDate()?(h.formatedStartTime=f(i,"HH:mm"),h.formatedEndTime=f(j,"HH:mm")):(h.formatedStartTime=f(i,u.formatHourColumn),h.formatedEndTime=f(j,u.formatHourColumn)),m=i<=k?0:(i-k)/C,n=j>=l?(l-k)/C:(j-k)/C,o=Math.floor(m);o<n-D;)c=B[o],c.hasEvent=!0,c.events=c.events||[],c.events.push(h),h.source=h.source||a.summary,c.eventSources=c.eventSources||{},c.eventSources[a.etag]=c.eventSources[a.etag]||{summary:a.summary,color:a.color,etag:a.etag},o+=1}for(d=0;d<42;d+=1)B[d].hasEvent&&B[d].events.sort(t);for(p=!1,d=0;d<42;d+=1){if(B[d].selected){u.selectedDate=B[d],p=!0,w.resize();break}if(p)break}}function p(a){var b,c=a.getFullYear(),d=a.getMonth(),e=new Date(c,d,1),f=u.startingDayMonth-e.getDay(),g=f>0?7-f:-f,h=new Date(e);return g>0&&h.setDate(-g+1),b=new Date(h),b.setDate(b.getDate()+42),{startTime:h,endTime:b}}function q(a,b){var c=new Array(b),d=new Date(a),e=0;for(d.setHours(12);e<b;)c[e++]=new Date(d),d.setDate(d.getDate()+1);return c}function r(a,b){return{date:a,label:f(a,b),formatedDayHeader:f(a,u.formatDayHeader)}}function s(a,b){var c,d=u.currentCalendarDate,e=new Date,f=864e5,g=Math.floor((d.getTime()-a.getTime())/f),h=Math.floor((e.getTime()-a.getTime())/f);for(c=0;c<42;c+=1)b.dates[c].selected=!1;g>=0&&g<42?(b.dates[g].selected=!0,u.selectedDate=b.dates[g],w.resize()):(u.selectedDate={events:[]},w.resize()),h>=0&&h<42&&(b.dates[h].current=!0)}function t(a,b){return a.allDay?1:b.allDay?-1:new Date(a.start.dateTime).getTime()-new Date(b.start.dateTime).getTime()}var u=this,v={$setViewValue:angular.noop},w=j.$getByHandle("event-detail-container");angular.forEach(["formatDay","formatDayHeader","formatMonthTitle","formatHourColumn","allDayLabel","noEventsLabel","showEventDetail","eventSources","queryMode","step","startingDayMonth","startingDayWeek"],function(c,e){u[c]=angular.isDefined(b[c])?e<6?d(b[c])(a.$parent):a.$parent.$eval(b[c]):g[c]}),u.mode={step:{months:1}},a.$parent.$watchCollection(b.eventSources,function(a){u.onEventSourceChanged(a)}),angular.isDefined(b.initDate)&&(u.currentCalendarDate=a.$parent.$eval(b.initDate)),u.currentCalendarDate||(u.currentCalendarDate=new Date,b.ngModel&&!a.$parent.$eval(b.ngModel)&&c(b.ngModel).assign(a.$parent,u.currentCalendarDate)),u.init=function(a){v=a,v.$render=function(){u.render()}},u.render=function(){var a,b;v.$modelValue&&(a=new Date(v.$modelValue),b=!isNaN(a),b?u.currentCalendarDate=a:e.error('"ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),v.$setValidity("date",b)),u.refreshView()},u.refreshView=function(){u.mode&&(u.range=p(u.currentCalendarDate),u.titleChanged&&u.titleChanged({title:l()}),u.populateAdjacentViews(),s(u.range.startTime,u.views[u.currentViewIndex]),k())},u.split=function(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c},u.onEventSourceChanged=function(a){u.eventSources=a,o&&o()},u.getAdjacentViewStartTime=function(a){var b=m(u.currentCalendarDate,a);return p(b).startTime},u.move=function(a){u.direction=a,u.moveOnSelected?u.moveOnSelected=!1:u.currentCalendarDate=m(u.currentCalendarDate,a),v.$setViewValue(u.currentCalendarDate),u.refreshView(),u.direction=0},u.registerSlideChanged=function(){u.currentViewIndex=0,u.slideChanged=function(b){var c,d;h(function(){c=u.currentViewIndex,d=0,b-c===1||0===b&&2===c?d=1:(c-b===1||2===b&&0===c)&&(d=-1),c=b,u.currentViewIndex=c,u.move(d),a.$digest()},200)}},u.populateAdjacentViews=function(){var a,b,c,d=u.currentViewIndex;1===u.direction?(a=u.getAdjacentViewStartTime(1),c=(d+1)%3,angular.copy(n(a),u.views[c])):u.direction===-1?(a=u.getAdjacentViewStartTime(-1),c=(d+2)%3,angular.copy(n(a),u.views[c])):u.views?(a=u.range.startTime,angular.copy(n(a),u.views[d]),a=u.getAdjacentViewStartTime(-1),c=(d+2)%3,angular.copy(n(a),u.views[c]),a=u.getAdjacentViewStartTime(1),c=(d+1)%3,angular.copy(n(a),u.views[c])):(b=[],a=u.range.startTime,b.push(n(a)),a=u.getAdjacentViewStartTime(1),b.push(n(a)),a=u.getAdjacentViewStartTime(-1),b.push(n(a)),u.views=b)},u.slideView=function(a){var b=i.$getByHandle("monthview-slide");b&&(1===a?b.next():a===-1&&b.previous())},u.select=function(a){var b,c,d,e,f,g,h,i,j,k,l,m=u.views;if(m){if(b=m[u.currentViewIndex].dates,d=u.currentCalendarDate,e=d.getMonth(),f=d.getFullYear(),g=a.getMonth(),h=a.getFullYear(),i=0,f===h?e!==g&&(i=e<g?1:-1):i=f<h?1:-1,u.currentCalendarDate=a,0===i){for(u.currentCalendarDate=a,v&&v.$setViewValue(a),j=u.range.startTime,k=864e5,l=Math.floor((a.getTime()-j.getTime())/k),c=0;c<42;c+=1)b[c].selected=!1;l>=0&&l<42&&(b[l].selected=!0,u.selectedDate=b[l],w.resize())}else u.moveOnSelected=!0,u.slideView(i);u.timeSelected&&u.timeSelected({selectedTime:a})}},u.getHighlightClass=function(a){var b="";return a.hasEvent&&(b="monthview-has-event"),a.selected&&(b&&(b+=" "),b+="monthview-selected"),a.current&&(b&&(b+=" "),b+="monthview-current"),a.secondary&&(b&&(b+=" "),b+="monthview-secondary"),b},u.registerSlideChanged()}angular.module("ui.rCalendar",[]),angular.module("ui.rCalendar").directive("calendar",function(){"use strict";return{restrict:"EA",replace:!0,templateUrl:"src/calendar-tpls.html",bindToController:!0,controllerAs:"vm",scope:{rangeChanged:"&",eventSelected:"&",timeSelected:"&",titleChanged:"&"},require:["calendar","?^ngModel"],controller:"ui.rCalendar.CalendarController",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f),a.$on("changeDate",function(a,b){e.slideView(b)}),a.$on("eventSourceChanged",function(a,b){e.onEventSourceChanged(b)})}}}),angular.module("ui.rCalendar").constant("calendarConfig",{formatDay:"dd",formatDayHeader:"EEE",formatMonthTitle:"MMMM yyyy",formatHourColumn:"dd MMMM, HH:mm",showEventDetail:!0,startingDayMonth:0,startingDayWeek:0,allDayLabel:"O dia todo",noEventsLabel:"Nenhum evento encontrado",eventSources:null,queryMode:"local"}),angular.module("ui.rCalendar").controller("ui.rCalendar.CalendarController",CalendarController),CalendarController.$inject=["$scope","$attrs","$parse","$interpolate","$log","dateFilter","calendarConfig","$timeout","$ionicSlideBoxDelegate","$ionicScrollDelegate"],angular.module("ui.rCalendar").directive("day",function(){"use strict";return{restrict:"A",replace:!0,templateUrl:"src/month-day-tpls.html",scope:{day:"=",onSelect:"&",getClasses:"&"}}});